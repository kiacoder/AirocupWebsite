<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <link
      rel="manifest"
      href="{{ url_for('static', filename=path.site_web_manifest) }}"
    />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {% set _is_admin = request.blueprint == 'admin' %}
    <meta
      name="robots"
      content="{{ 'noindex, nofollow' if _is_admin else 'index, follow' }}"
    />

    <title>
      {% block title %}{{ page_title if page_title is defined else 'صفحه اصلی'
      }}{% endblock %} | آیروکاپ
    </title>

    {% if not _is_admin %}
    <meta
      name="description"
      content="{{ seo_description if seo_description is defined else 'آیروکاپ، بزرگترین رویداد ملی هوش مصنوعی و رباتیک ایران به میزبانی دانشگاه علم و صنعت. در لیگ‌های متنوع شرکت کنید، نوآوری کنید و آینده را بسازید.' }}"
    />
    <meta
      name="keywords"
      content="{{ seo_keywords if seo_keywords is defined else 'آیروکاپ, مسابقات هوش مصنوعی, رباتیک, دانشگاه علم و صنعت, مسابقات ملی, Airocup, AI competitions, robotics' }}"
    />
    <meta name="author" content="Airocup" />
    <meta name="theme-color" content="#7b4baa" />

    <meta
      property="og:title"
      content="{% block og_title %}{{ page_title|striptags|trim if page_title is defined else 'آیروکاپ' }}{% endblock %}"
    />
    <meta
      property="og:description"
      content="{{ seo_description if seo_description is defined else 'به بزرگترین رویداد هوش مصنوعی و رباتیک ایران به میزبانی دانشگاه علم و صنعت ایران بپیوندید.' }}"
    />
    <meta
      property="og:image"
      content="{{ url_for('static', filename=path.solid_logos['solid_purple_glow'], _external=True) }}"
    />
    <meta property="og:url" content="{{ request.base_url }}" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="fa_IR" />
    <meta property="og:site_name" content="آیروکاپ" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="{% block twitter_title %}{{ page_title|striptags|trim if page_title is defined else 'آیروکاپ' }}{% endblock %}"
    />
    <meta
      name="twitter:description"
      content="{{ seo_description if seo_description is defined else 'آیروکاپ، نخستین رویداد ملی هوش مصنوعی و رباتیک ایران' }}"
    />
    <meta
      name="twitter:image"
      content="{{ url_for('static', filename=path.solid_logos['solid_purple_glow'], _external=True) }}"
    />
    <meta name="twitter:site" content="{{ contact.instagram }}" />

    <link rel="canonical" href="{{ request.base_url }}" />
    <link rel="alternate" href="{{ request.base_url }}" hreflang="fa-IR" />
    {% endif %}

    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" />

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename=path.css_style) }}"
    />

    {% if not _is_admin %}
    <link
      rel="icon"
      href="{{ url_for('static', filename=path.solid_logos['solid_white_favicon']) }}"
      type="image/x-icon"
    />
    <link
      rel="icon"
      type="image/png"
      href="{{ url_for('static', filename=path.solid_logos['main_fest_192']) }}"
    />
    <link
      rel="apple-touch-icon"
      href="{{ url_for('static', filename=path.solid_logos['main_fest_192']) }}"
    />
    {% endif %}

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    {% block head %}{% endblock %}
  </head>

  <body
    class="{{ 'admin-body' if _is_admin else 'client-page' }}"
    {%
    if
    not
    _is_admin
    %}
    data-client-id="{{ session.get('client_id', '') }}"
    {%
    endif
    %}
  >
    {% if _is_admin %}
    <header class="admin-header">
      <div class="admin-header-container container">
        <a
          href="{{ url_for('admin.admin_dashboard') }}"
          class="admin-header-logo"
        >
          <img
            src="{{ url_for('static', filename=path.transparent_logos['transparent_white']) }}"
            alt="پنل مدیریت آیروکاپ"
          />
          <span>پنل مدیریت آیروکاپ</span>
        </a>

        <nav class="admin-header-nav" id="admin-nav">
          <a href="{{ url_for('admin.admin_dashboard') }}">داشبورد</a>
          <a href="{{ url_for('admin.admin_clients_list') }}">کاربران</a>
          <a href="{{ url_for('admin.admin_manage_teams') }}">تیم‌ها</a>
          <a href="{{ url_for('admin.admin_manage_news') }}">اخبار</a>
          <a href="{{ url_for('global.logout') }}" class="btn btn-secondary"
            >خروج</a
          >
        </nav>

        <button
          class="admin-header-mobile-toggle"
          aria-controls="admin-nav"
          aria-expanded="false"
        >
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </header>

    {% else %}
    <header class="site-header">
      <div class="container header-inner">
        <div class="logo">
          <a href="{{ url_for('global.index') }}">
            <img
              src="{{ url_for('static', filename=path.transparent_logos['transparent_white']) }}"
              alt="لوگو آیروکاپ"
            />
          </a>
        </div>

        <nav class="main-nav" id="main-nav" role="navigation">
          <ul class="nav-list">
            <li>
              <a
                href="{{ url_for('global.index') }}"
                class="{{ 'active' if request.endpoint == 'global.index' }}"
                >صفحه اصلی</a
              >
            </li>
            <li>
              <a
                href="{{ url_for('global.leagues') }}"
                class="{{ 'active' if request.endpoint == 'global.leagues' }}"
                >لیگ‌ها</a
              >
            </li>
            <li>
              <a
                href="{{ url_for('global.committee') }}"
                class="{{ 'active' if request.endpoint == 'global.committee' }}"
                >کمیته</a
              >
            </li>
            <li>
              <a
                href="{{ url_for('global.sponsors') }}"
                class="{{ 'active' if request.endpoint == 'global.sponsors' }}"
                >حامیان</a
              >
            </li>
            <li>
              <a
                href="{{ url_for('global.gallery') }}"
                class="{{ 'active' if request.endpoint == 'global.gallery' }}"
                >گالری</a
              >
            </li>
            <li>
              <a
                href="{{ url_for('global.news') }}"
                class="{{ 'active' if request.endpoint == 'global.news' }}"
                >اخبار</a
              >
            </li>
            <li>
              <a
                href="{{ url_for('global.about') }}"
                class="{{ 'active' if request.endpoint == 'global.about' }}"
                >درباره ما</a
              >
            </li>
            <li>
              <a
                href="{{ url_for('global.contact') }}"
                class="{{ 'active' if request.endpoint == 'global.contact' }}"
                >تماس با ما</a
              >
            </li>
          </ul>
        </nav>

        <div class="header-actions">
          {% if 'client_id' in session %}
          <a href="{{ url_for('client.dashboard') }}" class="btn btn-secondary"
            >داشبورد</a
          >
          <a href="{{ url_for('client.support_chat') }}" class="btn btn-primary"
            >پشتیبانی</a
          >
          {% else %}
          <a
            href="{{ url_for('client.login_client') }}"
            class="btn btn-secondary"
            >ورود</a
          >
          <a href="{{ url_for('client.signup') }}" class="btn btn-primary"
            >ثبت‌نام</a
          >
          {% endif %}
        </div>

        <button
          class="mobile-menu-btn"
          aria-label="منوی موبایل"
          aria-expanded="false"
          aria-controls="main-nav"
        >
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </header>
    {% endif %} {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div id="flash-container" aria-live="polite" aria-atomic="true">
      {% set category_map = { 'success': {'icon': 'fa-check-circle', 'class':
      'flash-success'}, 'error': {'icon': 'fa-exclamation-triangle', 'class':
      'flash-error'}, 'warning': {'icon': 'fa-exclamation-circle', 'class':
      'flash-warning'}, 'info': {'icon': 'fa-info-circle', 'class':
      'flash-info'} } %} {% for category, message in messages %} {% set flash =
      category_map.get(category, category_map['info']) %}
      <div class="flash-message {{ flash.class }}" role="alert">
        <i class="fas {{ flash.icon }}" aria-hidden="true"></i>
        <span>{{ message }}</span>
        <button
          class="flash-close-btn"
          data-action="dismiss-flash"
          aria-label="بستن اعلان"
        >
          &times;
        </button>
      </div>
      {% endfor %}
    </div>
    {% endif %} {% endwith %}

    <main class="main-content">
      {% block breadcrumbs %}{% endblock %} {% block body %}{% endblock %}
    </main>

    {% if not _is_admin %}
    <footer class="site-footer">
      <!-- thin blue line above footer -->
      <div class="footer-top-line" aria-hidden="true"></div>

      <div class="container footer-content">
        <!-- animated cards row (logo / quick-links / contact) -->
        <div class="footer-cards">
          <div class="footer-card" aria-label="اطلاعات تماس">
            <h4>اطلاعات تماس</h4>
            <p>
              <i class="fas fa-map-marker-alt"></i> تهران، دانشگاه علم و صنعت
              ایران
            </p>
            <p><i class="fas fa-phone"></i> {{ contact.phone }}</p>
          </div>

          <div class="footer-card footer-card--logo" aria-label="لوگو آیروکاپ">
            <img
              src="{{ url_for('static', filename=path.transparent_logos['transparent_white']) }}"
              alt="Airocup logo"
              class="footer-card-logo"
            />
            <p class="footer-card-caption">
              آیروکاپ — پیشگام در آینده هوشمند ایران
            </p>
          </div>

          <div class="footer-card" aria-label="دسترسی سریع">
            <h4>دسترسی سریع</h4>
            <ul>
              <li><a href="{{ url_for('global.index') }}">صفحه اصلی</a></li>
              <li><a href="{{ url_for('global.leagues') }}">لیگ‌ها</a></li>
              <li><a href="{{ url_for('client.signup') }}">ثبت‌نام</a></li>
              <li><a href="{{ url_for('client.login_client') }}">ورود</a></li>
            </ul>
          </div>
        </div>

        <!-- existing footer text/links (keeps your older footer content) -->
        <div class="footer-bottom">
          <p class="footer-copy">
            &copy; {{ jdatetime.datetime.now().year }} تمامی حقوق برای آیروکاپ
            محفوظ است.
          </p>
          <p class="site-version">نسخه: {{ app_version }}</p>
        </div>
      </div>
    </footer>
    {% endif %}

    <script
      src="{{ url_for('static', filename='js/socket.io.min.js') }}"
      defer
    ></script>
    <script
      src="{{ url_for('static', filename='js/chart.umd.min.js') }}"
      defer
    ></script>

    {% if not _is_admin %}
    <script>
      window.AirocupData = {{ airocup_data | tojson | safe }};
    </script>
    {% endif %}
    <script src="{{ url_for('static', filename=path.js_main) }}" defer></script>
    {% block scripts %}
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        if (!("IntersectionObserver" in window)) {
          // If observer isn't available, reveal everything
          document
            .querySelectorAll(".footer-card")
            .forEach((el) => el.classList.add("is-visible"));
          return;
        }

        const observer = new IntersectionObserver(
          (entries, obs) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("is-visible");
                obs.unobserve(entry.target); // animate once
              }
            });
          },
          { threshold: 0.12 }
        ); // adjust threshold if you want earlier/late trigger

        document
          .querySelectorAll(".footer-card")
          .forEach((el) => observer.observe(el));
      });
    </script>
    {% endblock %}
  </body>
</html>
