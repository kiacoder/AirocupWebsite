{% extends "global/base.html" %} {% block title %}چت با {{ client.email }} | پنل
آیروکاپ{% endblock %} {% block body %}
<div
  class="AdminChatContainer"
  data-client-id="{{ client.client_id }}"
  data-history-url="{{ url_for('admin.get_chat_history', client_id=client.client_id) }}"
>
  <div class="PageHeader">
    <h1 class="SectionTitle">چت با کاربر</h1>
    <p class="FormSubtitle">
      شما در حال گفتگو با <strong>{{ client.email }}</strong> هستید.
    </p>
  </div>

  <div class="Card ChatWrapper">
    <div class="ChatBox" id="ChatBox" role="log">
      <div class="Loader" role="status" aria-live="polite">
        درحال بارگذاری تاریخچه...
      </div>
    </div>

    <div class="ChatInput">
      <div class="PersonaSelector">
        <label for="PersonaSelect">ارسال با نام:</label>
        <select id="PersonaSelect" class="FormControl">
          <option value="Admin">ادمین</option>
          {% for persona in personas %} {% if persona != 'Admin' %}
          <option value="{{ persona|e }}">{{ persona|e }}</option>
          {% endif %} {% endfor %}
        </select>
      </div>

      <div class="MessageInputGroup">
        <input
          type="text"
          id="MessageInput"
          placeholder="پاسخ خود را بنویسید..."
          autocomplete="off"
          aria-label="پیام"
        />
        <button id="SendButton" class="Btn BtnPrimary" aria-label="ارسال">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="SectionCta">
    <a
      href="{{ url_for('admin.admin_manage_client', client_id=client.client_id) }}"
      class="Btn BtnSecondary"
    >
      <i class="fas fa-arrow-left"></i> بازگشت به مدیریت کاربر
    </a>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (typeof AdminChat !== "undefined") {
      AdminChat.init();
    }
  });
</script>
{% endblock %}
