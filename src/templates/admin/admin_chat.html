{% extends "global/base.html" %}

{% block title %}چت با {{ client.email }} | پنل آیروکاپ{% endblock %}

{% block body %}
<div
  class="admin-chat-container"
  data-client-id="{{ client.client_id }}"
  data-history-url="{{ url_for('admin.get_chat_history', client_id=client.client_id) }}"
>
  <header class="admin-page__header">
    <div class="admin-page__title">
      <h1>چت با کاربر</h1>
      <p class="admin-page__subtitle">
        شما در حال گفتگو با <strong dir="ltr">{{ client.email }}</strong> هستید. پیام‌های جدید را در لحظه ببینید و پاسخ دهید.
      </p>
    </div>
    <div class="admin-page__actions">
      <a href="{{ url_for('admin.admin_manage_client', client_id=client.client_id) }}" class="btn btn-secondary">
        <i class="fas fa-arrow-right"></i>
        بازگشت به مدیریت کاربر
      </a>
    </div>
  </header>

  <section class="admin-chat-layout">
    <div class="admin-chat-layout__log" id="chat-box" role="log" aria-live="polite">
      <div class="Loader" role="status">درحال بارگذاری تاریخچه...</div>
    </div>
    <div class="admin-chat-layout__composer">
      <div class="admin-chat-layout__controls">
        <div>
          <label for="personaSelect">ارسال با نام:</label>
          <select id="personaSelect" class="form-control">
            <option value="Admin">ادمین</option>
            {% for persona in personas %}
              {% if persona != 'Admin' %}
              <option value="{{ persona|e }}">{{ persona|e }}</option>
              {% endif %}
            {% endfor %}
          </select>
        </div>
      </div>
      <div class="admin-chat-layout__message">
        <input
          type="text"
          id="message-input"
          placeholder="پاسخ خود را بنویسید..."
          autocomplete="off"
          aria-label="متن پیام"
        />
        <button id="send-button" class="btn btn-primary" aria-label="ارسال پیام">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </section>
</div>
{% endblock %}
