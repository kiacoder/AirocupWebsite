{% extends "global/base.html" %}

{% block title %}مدیریت جامع تیم‌ها | پنل آیروکاپ{% endblock %}

{% block body %}
<div class="Container">
  <div class="PageHeader">
    <h1 class="SectionTitle">مدیریت جامع تیم‌ها</h1>
    <p class="FormSubtitle">
      در این بخش تمام تیم‌های فعال در سیستم را مشاهده و مدیریت کنید.
    </p>
  </div>

  <div class="Card Card--table Card--centered-large">
    <h2 class="Card__header">
      <i class="fas fa-layer-group"></i> لیست تیم‌ها ({{ Teams|length | persian_digits }} تیم)
    </h2>

    <div class="UserTableWrapper">
      <table class="UserTable">
        <thead>
          <tr>
            <th>نام تیم</th>
            <th>کاربر مالک</th>
            <th>تعداد اعضا</th>
            <th>آخرین وضعیت پرداخت</th>
            <th class="ActionsHeader">عملیات</th>
          </tr>
        </thead>
        <tbody>
          {% for TeamData in Teams %}
          <tr>
            <td data-label="نام تیم">
              <strong>{{ TeamData.TeamName }}</strong><br />
              <span class="TeamId">ID: #{{ TeamData.TeamID | persian_digits }}</span>
            </td>
            <td data-label="کاربر">{{ TeamData.ClientEmail }}</td>
            <td data-label="اعضا">{{ TeamData.MemberCount | persian_digits }} نفر</td>
            <td data-label="وضعیت پرداخت">
              {% set status_enum = TeamData.LastPaymentStatus %}
              <span class="StatusBadge {% if status_enum and status_enum.value == 'Approved' %}StatusApproved{% elif status_enum and status_enum.value == 'Pending' %}StatusPending{% elif status_enum and status_enum.value == 'Rejected' %}StatusRejected{% else %}StatusNotStarted{% endif %}">
                {{ status_enum.label if status_enum else 'شروع نشده' }}
              </span>
            </td>
            <td class="Actions">
              <a href="{{ url_for('admin.admin_edit_team', team_id=TeamData.TeamID) }}" class="Btn BtnPrimary" title="مدیریت کامل تیم و اعضا">
                <i class="fas fa-edit"></i> مدیریت تیم
              </a>
            </td>
          </tr>
          {% else %}
          <tr class="EmptyStateRow">
            <td colspan="5" class="EmptyState">
                <i class="fas fa-layer-group EmptyState__icon"></i>
                هنوز هیچ تیمی در سیستم ثبت نشده است.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="SectionCta">
    <a href="{{ url_for('admin.admin_dashboard') }}" class="Btn BtnSecondary">
      <i class="fas fa-arrow-left"></i> بازگشت به داشبورد
    </a>
  </div>
</div>
{% endblock %}