{% extends "Global/Base.html" %} {% block Title %}اطلاعات پرداخت | آیروکاپ{%
endblock %} {% block Body %}
<div class="AppContainer">
  <div class="Container">
    <div class="PageHeader">
      <h1 class="SectionTitle">
        پرداخت هزینه ثبت‌نام برای تیم: {{ team.team_name }}
      </h1>
      <p class="SectionSubtitle">
        برای نهایی کردن ثبت‌نام, لطفا مبلغ نهایی را به حساب زیر واریز کرده و سپس
        تصویر رسید را بارگذاری نمایید.
      </p>
    </div>

    <div class="PaymentGrid">
      <div class="Card PaymentInfoCard">
        <h2><i class="fas fa-university"></i> اطلاعات حساب بانکی</h2>
        <div class="PaymentDetails">
          <div class="DetailItem">
            <span>بانک</span>
            <strong>{{ payment.bank_name }}</strong>
          </div>
          <div class="DetailItem Copyable">
            <span>صاحب حساب</span>
            <div class="ValueWithCopy">
              <strong>{{ payment.owner_name }}</strong>
              <button
                class="copy-btn"
                data-copy="{{ payment.owner_name }}"
                title="کپی کردن"
              >
                <i class="far fa-copy"></i>
              </button>
            </div>
          </div>
          <div class="DetailItem Copyable">
            <span>شماره کارت</span>
            <div class="ValueWithCopy">
              <strong dir="ltr">{{ payment.card_number }}</strong>
              <button
                class="copy-btn"
                data-copy="{{ payment.card_number | replace('-', '') }}"
                title="کپی کردن"
              >
                <i class="far fa-copy"></i>
              </button>
            </div>
          </div>
          <div class="DetailItem Copyable">
            <span>شماره شبا (IBAN)</span>
            <div class="ValueWithCopy">
              <strong dir="ltr">{{ payment.iban }}</strong>
              <button
                class="copy-btn"
                data-copy="{{ payment.iban }}"
                title="کپی کردن"
              >
                <i class="far fa-copy"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="Card PaymentSummaryCard">
        <h2><i class="fas fa-file-invoice-dollar"></i> خلاصه هزینه‌ها</h2>
        <div class="PaymentDetails">
          {% if is_new_member_payment %}
          <div
            class="Alert Alert--Info"
            role="alert"
            style="text-align: center"
          >
            هزینه برای
            <strong>{{ members_to_pay_for | persian_digits }} عضو جدید</strong>
            محاسبه شده است.
          </div>
          <div class="DetailItem">
            <span>هزینه هر عضو جدید</span>
            <strong
              >{{ payment.fee_per_person | humanize_number | persian_digits }}
              ریال</strong
            >
          </div>
          <div class="DetailItem">
            <span>تعداد اعضای جدید</span>
            <strong>{{ members_to_pay_for | persian_digits }} نفر</strong>
          </div>
          {% else %}
          <div class="DetailItem">
            <span>هزینه ورودی تیم</span>
            <strong
              >{{ payment.fee_team | humanize_number | persian_digits }}
              ریال</strong
            >
          </div>
          <div class="DetailItem">
            <span>هزینه ثبت‌نام ({{ num_members | persian_digits }} عضو)</span>
            <strong
              >{{ (num_members * payment.fee_per_person) | humanize_number |
              persian_digits }} ریال</strong
            >
          </div>
          <hr class="SummaryDivider" />
          <div class="DetailItem SubtotalItem">
            <span>هزینه پایه (لیگ اول)</span>
            <strong
              >{{ league_one_cost | humanize_number | persian_digits }}
              ریال</strong
            >
          </div>
          {% if league_two_cost > 0 %}
          <div class="DetailItem">
            <span>هزینه لیگ دوم</span>
            <strong
              >{{ league_two_cost | humanize_number | persian_digits }}
              ریال</strong
            >
          </div>
          <div class="DetailItem DiscountAmount">
            <span
              >تخفیف {{ payment.league_two_discount | persian_digits }}٪ برای
              لیگ دوم</span
            >
            <strong
              >- {{ discount_amount | humanize_number | persian_digits }}
              ریال</strong
            >
          </div>
          {% endif %} {% endif %}
          <hr class="SummaryDivider" />
          <div class="DetailItem TotalAmount Copyable">
            <span>مبلغ نهایی قابل پرداخت</span>
            <div class="ValueWithCopy">
              <strong class="FinalAmount"
                >{{ total_fee | humanize_number | persian_digits }} ریال</strong
              >
              <button
                class="copy-btn"
                data-copy="{{ total_fee }}"
                title="کپی کردن مبلغ"
              >
                <i class="far fa-copy"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="CardFooter">
          <form
            method="POST"
            action="{{ url_for('client.payment', team_id=team.team_id) }}"
            enctype="multipart/form-data"
          >
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
            <p class="UploadInstruction">
              پس از واریز وجه, لطفا <strong>تصویر رسید پرداخت</strong> را
              بارگذاری کنید.
            </p>
            <div class="FormGroup">
              <label for="receipt" class="Btn BtnSecondary FileUploadBtn">
                <i class="fas fa-paperclip"></i> انتخاب فایل رسید
              </label>
              <input
                type="file"
                id="receipt"
                name="receipt"
                required
                class="FileUploadInput"
                accept="image/*,.pdf"
              />
              <span id="filename" class="FileNameDisplay"
                >هیچ فایلی انتخاب نشده</span
              >
            </div>
            <button type="submit" class="Btn BtnPrimary Btn--fullWidth">
              ارسال رسید و نهایی کردن پرداخت
            </button>
          </form>
        </div>
      </div>
    </div>

    <div
      class="SectionCta"
      style="text-align: center; margin-top: 20px; margin-bottom: 20px"
    >
      <a href="{{ url_for('client.dashboard') }}" class="Btn BtnSecondary">
        <i class="fas fa-arrow-left"></i> بازگشت به داشبورد
      </a>
    </div>
  </div>
</div>
{% endblock %} {% block Scripts %} {{ super() }} {# Script removed. File input
and copy buttons are now handled by main.js globally. #} {% endblock %}
