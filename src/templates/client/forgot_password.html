{% extends "Global/Base.html" %}

{% block Title %}بازیابی رمز عبور | آیروکاپ{% endblock %}

{% block Body %}
<div class="AppContainer">
  <div class="FormContainer FormContainer--small">
    <form method="POST" action="{{ url_for('client.forgot_password') }}" id="ForgotPasswordForm" novalidate>
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

      <h1 class="FormTitle">بازیابی رمز عبور</h1>
      <p class="FormSubtitle">
        لطفا ایمیل یا شماره موبایل حساب کاربری خود را وارد کنید.
      </p>

      <div class="FormGroup">
        <label for="identifier">ایمیل یا شماره موبایل:</label>
        <input type="text" id="identifier" name="Identifier" placeholder="ایمیل یا شماره موبایل" required autofocus dir="ltr" />
        <span class="ErrorMsg" id="identifierError"></span>
      </div>

      <div class="FormGroup">
        <button type="submit" class="Btn BtnPrimary Btn--fullWidth">
          ارسال کد بازیابی
        </button>
      </div>

      <div class="FormLinks" style="text-align: center">
        <p><a href="{{ url_for('client.login_client'') }}">بازگشت به صفحه ورود</a></p>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block Scripts %}
{{ super() }}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("ForgotPasswordForm");
    const identifierInput = document.getElementById("identifier");
    const identifierError = document.getElementById("identifierError");

    if (form) {
        form.addEventListener("submit", function (event) {
            const value = identifierInput.value.trim();
            const isPhone = Validators.IsValidIranianPhone(value);
            const isEmail = Validators.IsValidEmail(value);

            if (!isPhone && !isEmail) {
                event.preventDefault();
                identifierError.textContent = "لطفا یک ایمیل یا شماره موبایل معتبر وارد کنید.";
                identifierInput.focus();
            } else {
                identifierError.textContent = "";
            }
        });
    }
  });
</script>
{% endblock %}