{% extends "Global/Base.html" %}

{% block Title %}تاریخچه پرداخت‌ها | آیروکاپ{% endblock %}

{% block Body %}
<div class="AppContainer">
  <div class="Container">
    <div class="PageHeader">
      <h1 class="SectionTitle">تاریخچه پرداخت‌ها</h1>
      <p class="SectionSubtitle">
        در این بخش می‌توانید تمام پرداخت‌های انجام شده و وضعیت آن‌ها را مشاهده کنید.
      </p>
    </div>

    <div class="Card Card--table">
      <h2 class="Card__header">لیست تراکنش‌ها</h2>
      <div class="UserTableWrapper">
        {% if Payments %}
        <table class="UserTable">
          <thead>
            <tr>
              <th>نام تیم</th>
              <th>مبلغ (ریال)</th>
              <th>تاریخ</th>
              <th>وضعیت</th>
              <th>رسید</th>
            </tr>
          </thead>
          <tbody>
            {% for payment in Payments %}
            <tr>
              <td data-label="نام تیم">{{ payment.TeamName }}</td>
              <td data-label="مبلغ">{{ payment.Amount | humanize_number | persian_digits }}</td>
              <td data-label="تاریخ">{{ payment.UploadDate | formatdate | persian_digits }}</td>
              <td data-label="وضعیت">
                <span class="StatusBadge {% if payment.Status.value == 'Approved' %}StatusApproved{% elif payment.Status.value == 'Pending' %}StatusPending{% elif payment.Status.value == 'Rejected' %}StatusRejected{% else %}StatusNotStarted{% endif %}">
                  {{ payment.Status.label }}
                </span>
              </td>
              <td data-label="رسید">
                {% if payment.ReceiptFilename %}
                <a href="{{ url_for('Client.GetReceipt', ClientID=payment.ClientID, filename=payment.ReceiptFilename) }}" class="Btn BtnSecondary BtnSm" target="_blank" rel="noopener noreferrer">
                  <i class="fas fa-receipt"></i> مشاهده
                </a>
                {% else %}
                <span>-</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
        <div class="Card EmptyStateCard">
          <i class="fas fa-history EmptyStateIcon"></i>
          <h3>سابقه پرداخت خالی است</h3>
          <p>شما هنوز هیچ پرداختی انجام نداده‌اید.</p>
        </div>
        {% endif %}
      </div>
    </div>

    <div class="SectionCta" style="text-align: center; margin-top: 2rem">
      <a href="{{ url_for('Client.Dashboard') }}" class="Btn BtnSecondary">
        <i class="fas fa-arrow-left"></i> بازگشت به داشبورد
      </a>
    </div>
  </div>
</div>
{% endblock %}